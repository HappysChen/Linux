*******
 一、线程
   1、概念
         线程（英语：thread）是操作系统能够进行运算调度的最小单位。大部分情况下，它被包含在进程之中，是进程中的实际运作单位。
     一条线程指的是进程中一个单一顺序的控制流，一个进程中可以并发多个线程，每条线程并行执行不同的任务。
         在Unix System V及SunOS中也被称为轻量进程（lightweight processes），但轻量进程更多指内核线程（kernel thread），而把用户线程（user thread）称为线程。
         线程是独立调度和分派的基本单位。
         同一进程中的多条线程将共享该进程中的全部系统资源，如虚拟地址空间，文件描述符和信号处理、用户ID和组ID等
         但同一进程中的多个线程有各自的调用栈（call stack），自己的寄存器环境（register context），自己的线程本地存储（thread-local storage）。
         一个进程可以有很多线程来处理，每条线程并行执行不同的任务。
         LWP： 轻量级的进程，本质是进程（在Linux环境下）
         进程：独立地址空间，拥有PCB
         线程：也有PCB，但没有独立的地址空间（共享）
   2、线程与进程的区别：
         是否共享地址空间，举例：独居（进程），合租（线程）。
         Linux下：线程：最小的执行单位
         进程：最小分配资源单位，可看成是只有一个线程的进程。
         
   3、Linux内核线程实现原理
        1、轻量级进程，也有PCB，创建线程使用的底层函数和进程一样，都是clone
        2、从内核里看进程和线程是一样的，都有各自不同的PCB，但是PCB中指向内存资源的三级页表是相同的
        3、进程可以蜕变成线程
        4、线程可以看做寄存器和栈的集合
        5、在linux下，线程是最小的执行单位，进程是最小的分配资源单位
        
     查看LWP号：ps-Lf pid 查看指定线程的lwp号。 
       
   4、线程非共享资源
      1、线程ID
      2、处理器现场和栈指针（内核栈）
      3、独立的栈空间（用户空间栈）
      4、errno变量
      5、信号屏蔽字
      6、调度优先级
  5、线程优、缺点  百度
  
  6、线程控制函数
    1）创建子线程
    #include<pthread.h>
    创建用户级线程：
     int pthread_create(pthread_t * thread, const pthread_attr_t * attr, void *(*start_routine)(void *), void *arg); //创建一个线程 attr为函数名
          成功：0；失败：error number 
     参数：
       pthread_t: 在 linux 中，typedef unsigned long int pthread_t
       参数1：传出参数，保存系统为我们分配好的线程ID
       参数2：通常为NULL，表示使用线程默认属性。若想使用具体属性也可以修改该参数
       参数3：函数指针，指向线程主函数（线程体），该函数运行结束，则线程结束
       参数4：线程主函数执行期间所使用的参数。
       
    返回当前用户级线程的线程标识符：
     pthread_t pthread_self(void);  
    2）创建循环线程
       int N,i;
       pthread_t pth;
     
     void func(void *arg)
      { 
       //还可以实现其他功能
        int i= (int)arg;
        printf("%dth pthread id = %lu,pid = %d\n",i+1,pthread_self(),getpid());
        //sleep();
        return NULL;
      }
       
       for (i = 0;i<N;i++)
        {
          int ret = pthread_create(&pth,NULL,func, (void *)i); //func为函数名， (void *)i 不是(void*)&i,传入地址的话，在函数func()中，打印出来的是父线程中i那个的地址所存的值
          if(ret!=0)
          { 
           fprintf(stdre,"pthread create fail,id is= %s\n",strerror(ret));
           exit(1);
          }
        }
     3)、线程共享全局变量
       
     4）、线程退出
       void pthread_exit(void *retval);将调用该函数的线程退出
       return；返回到调用者那里去
       exit;  将进程退出
      
  
  
  
       






